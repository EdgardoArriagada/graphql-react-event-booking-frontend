(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,a){},5446:function(e,t,a){e.exports=a(5626)},5470:function(e,t,a){},5541:function(e,t,a){},5613:function(e,t,a){},5619:function(e,t,a){},5623:function(e,t,a){},5624:function(e,t,a){},5625:function(e,t,a){},5626:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),o=a.n(c),i=(a(116),a(51)),l=a(45),s=a(18),u=a(23),m=a.n(u),d=a(26),E=a.n(d),p=(a(5470),{isSideDrawOpen:!1}),f=function(e,t){switch(t.type){case"UI_TOGGLE_SIDE_NAV":return{isSideDrawOpen:!e.isSideDrawOpen};default:return e||p}},h={token:null,userId:null,tokenExpiration:null},b=function(e,t){switch(t.type){case"AUTH_LOG_IN":return{token:t.token,userId:t.userId,tokenExpiration:t.tokenExpiration};case"AUTH_LOG_OUT":return h;default:return e||h}},v=a(39),g={events:[],status:"PRISTINE"},_=function(e,t){switch(t.type){case"FETCH_EVENTS_PENDING":return{events:Object(v.a)(e.events),status:"PENDING"};case"FETCH_EVENTS_FULFILLED":return{events:Object(v.a)(t.events),status:"FULFILLED"};case"FETCH_EVENTS_REJECTED":return{events:Object(v.a)(e.events),status:"REJECTED"};default:return e||g}},O={bookings:[],status:"PRISTINE"},y=function(e,t){switch(t.type){case"FETCH_BOOKINGS_PENDING":case"CANCEL_BOOKINGS_PENDING":return{bookings:Object(v.a)(e.bookings),status:"PENDING"};case"FETCH_BOOKINGS_FULFILLED":return{bookings:Object(v.a)(t.bookings),status:"FULFILLED"};case"CANCEL_BOOKINGS_FULFILLED":return{bookings:e.bookings.filter(function(e){return t.bookingId!==e._id}),status:"FULFILLED"};case"FETCH_BOOKINGS_REJECTED":case"CANCEL_BOOKINGS_REJECTED":return{bookings:Object(v.a)(e.bookings),status:"REJECTED"};default:return e||O}},N=Object(n.createContext)({}),C=function(){return Object(n.useContext)(N)},S=a(22),k={primaryButton:{margin:"0.25rem 0.1rem"},modalCentered:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},card:{width:"30rem",margin:"0.5rem auto",maxWidth:"80%",display:"flex",flexDirection:"column",alignItems:"center"}},w=Object(S.createMuiTheme)({palette:{primary:{main:"#800080"}},typography:{useNextVariants:!0}}),j=a(32),I={production:{BACKEND_URL:"https://easy-event-0.herokuapp.com/"},development:{BACKEND_URL:"http://localhost:3000"}},D=Object(j.a)({},I["production"],{getGraphqlUrl:function(){return this.BACKEND_URL+"/graphql"}}),T=function(){var e=C().AuthDispatch,t=Object(n.useState)(!0),a=Object(s.a)(t,2),c=a[0],o=a[1],i=Object(n.useRef)({}),l=Object(n.useRef)({});return r.a.createElement("form",{className:"auth-page",onSubmit:function(t){t.preventDefault();var a=i.current.value.trim(),n=l.current.value.trim();if(a&&n){var r={query:'\n            mutation {\n                createUser(userInput: {email:"'.concat(a,'", password:"').concat(n,'"}) {\n                  _id\n                  email\n                }\n              }\n            ')},o={query:'\n            query {\n                login(email:"'.concat(a,'", password:"').concat(n,'") {\n                  userId\n                  token\n                  tokenExpiration\n                }\n              }\n            ')};E()({url:D.getGraphqlUrl(),method:"POST",data:c?o:r,headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(t){if(t.login){var a=t.login,n=a.token,r=a.userId,c=a.tokenExpiration;e({type:"AUTH_LOG_IN",token:n,userId:r,tokenExpiration:c})}}).catch(function(e){console.log(e)})}}},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"email"},"E-mail"),r.a.createElement("input",{type:"email",id:"email",ref:i})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",ref:l})),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",style:k.primaryButton},c?"Login":"Signup"),r.a.createElement("span",null),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"button",style:k.primaryButton,onClick:function(e){return o(!c)}},"Switch to ",c?"Signup":"Login"))},L=a(9),B=a(38),F=Object(S.withStyles)(function(e){return{paper:{position:"absolute",width:50*e.spacing.unit,maxWidth:"80%",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],outline:"none"}}})(function(e){var t=e.classes,a=Object(B.a)(e,["classes"]);return r.a.createElement("div",{className:t.paper,style:k.modalCentered},a.children)}),A=a(44),x=a(64),G=a(113),U=a(5628),R=a(5630),H=a(163),P=a(162),q=a(164),K=a(5629),J=a(8),V=a.n(J),z=(a(5541),Object(S.withStyles)(function(e){return{header:{backgroundColor:e.palette.primary.main,color:"white",padding:"0.3rem 1.5rem"},content:{margin:"1.5rem"},actions:{}}})(function(e){var t=e.classes,a=Object(B.a)(e,["classes"]),c=C().AuthState,o=Object(n.useState)(new Date),i=Object(s.a)(o,2),l=i[0],u=i[1],m=Object(n.useState)(new Date),d=Object(s.a)(m,2),p=d[0],f=d[1],h=Object(n.useRef)({}),b=Object(n.useRef)({}),v=Object(n.useRef)({});return r.a.createElement(F,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(L.l,{className:t.header,variant:"h6"},"Create Event"),r.a.createElement("form",{className:V()(t.content,"create-event-modal-content__form"),onSubmit:function(e){e.preventDefault();var t=h.current.value.trim(),n=b.current.value.trim(),r=v.current.value.trim(),o=function(e,t){if(!e||!t)throw new Error("Date and time must be selected");var a=new Date;return a=Object(U.a)(a,Object(R.a)(e)),a=Object(H.a)(a,Object(P.a)(t)),(a=Object(q.a)(a,Object(K.a)(t))).toISOString()}(l,p);if(!t||!n||!r||!o)throw new Error("All input must be selected");var i={query:'mutation {\n                createEvent(eventInput: {title: "'.concat(t,'", description: "').concat(n,'",\n                price: ').concat(parseFloat(r),', date: "').concat(o,'"}) {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                }\n            }')};E()({url:D.getGraphqlUrl(),method:"POST",data:i,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e),a.fetchEvents(),a.closeModal()}).catch(function(e){console.log(e)})}},r.a.createElement(L.g,{className:"create-event-modal-content__title"},r.a.createElement(L.k,{id:"title",variant:"outlined",label:"Title",inputRef:h})),r.a.createElement(L.g,{className:"create-event-modal-content__description"},r.a.createElement(L.k,{id:"description",variant:"outlined",label:"description",inputRef:b})),r.a.createElement(L.g,{className:"create-event-modal-content__date"},r.a.createElement(x.c,{utils:G.a},r.a.createElement(x.a,{keyboard:!0,clearable:!0,variant:"outlined",label:"Date",onChange:u,value:l}))),r.a.createElement(L.g,{className:"create-event-modal-content__time"},r.a.createElement(x.c,{utils:G.a},r.a.createElement(x.b,{keyboard:!0,variant:"outlined",keyboardIcon:r.a.createElement(A.a,null),label:"Time",onChange:f,value:p}))),r.a.createElement(L.g,{className:"create-event-modal-content__price"},r.a.createElement(L.k,{id:"price",variant:"outlined",label:"price",inputRef:v})),r.a.createElement(L.f,{className:"create-event-modal-content__actions-divider"}),r.a.createElement("div",{className:V()(t.actions,"create-event-modal-content__actions")},r.a.createElement(L.a,{variant:"text",color:"primary",onClick:a.closeModal,style:k.primaryButton},"Cancel"),r.a.createElement(L.a,{variant:"contained",color:"primary",type:"submit",style:k.primaryButton},"Create")))))})),M=Object(S.withStyles)(function(e){return{card:Object(j.a)({},k.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(B.a)(e,["classes"]);var n=C().AuthState,c=a.event,o=Boolean(n.token),i=n.userId===c.creator._id;return r.a.createElement(L.b,{className:t.card},r.a.createElement(L.e,{className:t.cardHeader,title:c.title,action:i&&r.a.createElement(L.h,{"aria-label":"Edit"},r.a.createElement(A.b,{fontSize:"small"}))}),r.a.createElement(L.d,{className:t.cardContent},r.a.createElement("span",{className:V()(t.cardContentItem,t.cardDescription)},r.a.createElement(L.l,{variant:"body1",gutterBottom:!0},c.description),r.a.createElement(L.l,{variant:"caption",gutterBottom:!0},new Date(c.date).toLocaleString()),r.a.createElement(L.l,{variant:"h6"},c.price," USD ")),i&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(L.l,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(L.c,{className:t.cardActions},r.a.createElement(L.a,{variant:"text"},"Details"),!i&&r.a.createElement(L.a,{variant:"text",color:"primary",onClick:function(){if(o){var e={query:'mutation {\n                bookEvent(eventId: "'.concat(c._id,'") {\n                  _id\n                  createdAt\n                  updatedAt\n                }\n              }')};E()({url:D.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}else alert("you should log in to book an event")}},"Book this")))}),W=Object(S.withStyles)(function(e){return{}})(function(e){e.classes;var t=C().EventsState.events.map(function(e){return r.a.createElement(M,{event:e,key:e._id})});return r.a.createElement("section",null,t)}),Y=Object(S.withStyles)(function(e){return{card:Object(j.a)({},k.card)}})(function(e){var t=e.classes,a=!0,c=C().EventsDispatch,o=Object(n.useState)(1),i=Object(s.a)(o,2),l=i[0],u=i[1];function d(){a&&u(10),c({type:"FETCH_EVENTS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:{query:"query {\n                events {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                    creator{\n                        _id\n                        email\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_EVENTS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_EVENTS_FULFILLED",events:e.events}),a&&u(100)}).catch(function(e){c({type:"FETCH_EVENTS_REJECTED"})}).finally(function(){setTimeout(function(){a&&u(0)},300)})}Object(n.useEffect)(function(){return d(),function(){a=!1}},[]);var p=C().AuthState,f=Boolean(p.token),h=Object(n.useState)(!1),b=Object(s.a)(h,2),v=b[0],g=b[1];return r.a.createElement("div",{className:"events-page app-centered-page"},Boolean(l)&&r.a.createElement(L.i,{variant:"determinate",value:l}),f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(L.b,{className:t.card},r.a.createElement(L.l,null,"Share your own Event!"),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"button",onClick:function(e){return g(!0)}},"Create Event")),r.a.createElement(L.j,{open:v,onClose:function(e){return g(!1)}},r.a.createElement(z,{closeModal:function(){g(!1)},fetchEvents:d}))),r.a.createElement(W,null))}),Q=Object(S.withStyles)(function(e){return{card:Object(j.a)({},k.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(B.a)(e,["classes"]),n=C(),c=n.AuthState,o=n.BookingsDispatch,i=a.booking,l=i.event,s=Boolean(c.token),u=c.userId===i.event.creator._id;return r.a.createElement(L.b,{className:t.card},r.a.createElement(L.e,{className:t.cardHeader,title:l.title,action:r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(L.h,{"aria-label":"Edit"},r.a.createElement(A.b,{fontSize:"small"})),r.a.createElement(L.h,{"aria-label":"Delete",onClick:function(){if(s){var e={query:'mutation {\n                cancelBooking(bookingId: "'.concat(i._id,'") {\n                  _id\n                  title\n                }\n              }')};o({type:"CANCEL_BOOKINGS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){o({type:"CANCEL_BOOKINGS_FULFILLED",bookingId:i._id}),console.log(e)}).catch(function(e){o({type:"CANCEL_BOOKINGS_REJECTED"}),console.log(e)})}else alert("you should log in to cancel an event")}},r.a.createElement(A.c,{fontSize:"small"})))}),r.a.createElement(L.d,{className:t.cardContent},r.a.createElement("span",{className:V()(t.cardContentItem,t.cardDescription)},r.a.createElement(L.l,{variant:"body1",gutterBottom:!0},l.description),r.a.createElement(L.l,{variant:"caption",gutterBottom:!0},new Date(l.date).toLocaleString()),r.a.createElement(L.l,{variant:"h6"},l.price," USD ")),u&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(L.l,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(L.c,{className:t.cardActions},r.a.createElement(L.a,{variant:"text"},"Details")))}),X=Object(S.withStyles)(function(e){return{}})(function(e){e.classes;var t=C().BookingsState.bookings.map(function(e){return r.a.createElement(Q,{booking:e,key:e._id})});return r.a.createElement("section",null,t)}),Z=Object(S.withStyles)(function(e){return{card:Object(j.a)({},k.card)}})(function(e){e.classes;var t=!0,a=C(),c=a.BookingsDispatch,o=a.AuthState,i=Object(n.useState)(1),l=Object(s.a)(i,2),u=l[0],m=l[1];return Object(n.useEffect)(function(){return t&&m(10),c({type:"FETCH_BOOKINGS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:{query:"query {\n                bookings {\n                    _id\n                    createdAt\n                    event {\n                        _id\n                        title\n                        date\n                        price\n                        creator {\n                            _id\n                        }\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.token}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_BOOKINGS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_BOOKINGS_FULFILLED",bookings:e.bookings}),t&&m(100)}).catch(function(e){c({type:"FETCH_BOOKINGS_REJECTED"})}).finally(function(){setTimeout(function(){t&&m(0)},300)}),function(){t=!1}},[]),r.a.createElement("div",{className:"bookins-page .app-centered-page"},Boolean(u)&&r.a.createElement(L.i,{variant:"determinate",value:u}),r.a.createElement(X,null))}),$=(a(5613),function(){var e=C().UIDisptch;return r.a.createElement("button",{className:"drawer-toggle-button",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}},r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}))}),ee=function(){var e=C().AuthState;return r.a.createElement("nav",null,r.a.createElement("ul",null,!e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/auth"},"Log In")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/events"},"Events")),e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/bookings"},"Bookings"))))},te=a(33),ae=a.n(te),ne=a(82),re=a.n(ne),ce=a(81),oe=a.n(ce),ie=a(63),le=a.n(ie),se=(a(5619),function(){var e=C(),t=e.AuthState,a=e.AuthDispatch,c=Boolean(t.token),o=Object(n.useState)(),i=Object(s.a)(o,2),l=i[0],u=i[1],m=Boolean(l);function d(){u(null)}var E=r.a.createElement(oe.a,{anchorEl:l,open:m,onClose:d},r.a.createElement(le.a,{onClick:void 0},"Profile"),r.a.createElement(le.a,{onClick:function(){a({type:"AUTH_LOG_OUT"}),d()}},"Logout"));return r.a.createElement("header",{className:"main-navigation"},r.a.createElement("span",{className:"main-navigation__logo"},r.a.createElement("span",{className:"main-navigation__button"},r.a.createElement($,null)),r.a.createElement("h1",null,"EasyEvent")),r.a.createElement("span",{className:"main-navigation__items"},r.a.createElement("span",{className:"main-navigation__links"},r.a.createElement(ee,null)),c&&r.a.createElement(ae.a,{onClick:function(e){u(e.currentTarget)}},r.a.createElement(re.a,{className:"account-circle"}))),E)}),ue=(a(5623),a(5624),function(){var e=["side-drawer"];return C().UIState.isSideDrawOpen&&e.push("side-drawer__open"),r.a.createElement("span",{className:e.join(" ")},r.a.createElement(ee,null))}),me=(a(5625),function(){var e=C().UIDisptch;return r.a.createElement("div",{className:"backdrop",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}})});var de=function(){var e,t=C(),a=t.UIState,n=t.AuthState,c=Boolean(n.token);return a.isSideDrawOpen&&(e=r.a.createElement(me,null)),r.a.createElement("div",{className:"main-content"},r.a.createElement(i.a,null,r.a.createElement(se,null),r.a.createElement(ue,null),e,r.a.createElement("main",null,r.a.createElement(l.d,null,c&&r.a.createElement(l.a,{from:"/",to:"/events",exact:!0}),c&&r.a.createElement(l.a,{from:"/auth",to:"/events",exact:!0}),!c&&r.a.createElement(l.b,{path:"/auth",component:T}),c&&r.a.createElement(l.b,{path:"/bookings",component:Z}),r.a.createElement(l.b,{path:"/events",component:Y}),!c&&r.a.createElement(l.a,{to:"/auth"})))))};o.a.render(r.a.createElement(S.MuiThemeProvider,{theme:w},r.a.createElement(function(e){var t=e.children,a=Object(n.useReducer)(f,p),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useReducer)(b,h),u=Object(s.a)(l,2),m=u[0],d=u[1],E=Object(n.useReducer)(_,g),v=Object(s.a)(E,2),C=v[0],S=v[1],k=Object(n.useReducer)(y,O),w=Object(s.a)(k,2),j={UIState:o,UIDisptch:i,AuthState:m,AuthDispatch:d,EventsState:C,EventsDispatch:S,BookingsState:w[0],BookingsDispatch:w[1]};return r.a.createElement(N.Provider,{value:j},t)},null,r.a.createElement(de,null))),document.getElementById("root"))}},[[5446,1,2]]]);
//# sourceMappingURL=main.797605c0.chunk.js.map