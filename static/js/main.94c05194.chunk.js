(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){},5446:function(e,t,a){e.exports=a(5630)},5470:function(e,t,a){},5595:function(e,t,a){},5617:function(e,t,a){},5623:function(e,t,a){},5627:function(e,t,a){},5628:function(e,t,a){},5629:function(e,t,a){},5630:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),o=a.n(c),i=(a(120),a(53)),l=a(45),s=a(18),u=a(23),m=a.n(u),d=a(27),E=a.n(d),p=(a(5470),{isSideDrawOpen:!1}),f=function(e,t){switch(t.type){case"UI_TOGGLE_SIDE_NAV":return{isSideDrawOpen:!e.isSideDrawOpen};default:return e||p}},b={token:null,userId:null,tokenExpiration:null},h=function(e,t){switch(t.type){case"AUTH_LOG_IN":return{token:t.token,userId:t.userId,tokenExpiration:t.tokenExpiration};case"AUTH_LOG_OUT":return b;default:return e||b}},v=a(40),O={events:[],status:"PRISTINE"},g=function(e,t){switch(t.type){case"FETCH_EVENTS_PENDING":return{events:Object(v.a)(e.events),status:"PENDING"};case"FETCH_EVENTS_FULFILLED":return{events:Object(v.a)(t.events),status:"FULFILLED"};case"FETCH_EVENTS_REJECTED":return{events:Object(v.a)(e.events),status:"REJECTED"};default:return e||O}},_={bookings:[],status:"PRISTINE"},S=function(e,t){switch(t.type){case"FETCH_BOOKINGS_PENDING":case"CANCEL_BOOKINGS_PENDING":return{bookings:Object(v.a)(e.bookings),status:"PENDING"};case"FETCH_BOOKINGS_FULFILLED":return{bookings:Object(v.a)(t.bookings),status:"FULFILLED"};case"CANCEL_BOOKINGS_FULFILLED":return{bookings:e.bookings.filter(function(e){return t.bookingId!==e._id}),status:"FULFILLED"};case"FETCH_BOOKINGS_REJECTED":case"CANCEL_BOOKINGS_REJECTED":return{bookings:Object(v.a)(e.bookings),status:"REJECTED"};default:return e||_}},N=Object(n.createContext)({}),y=function(){return Object(n.useContext)(N)},C=a(22),I={primaryButton:{margin:"0.25rem 0.1rem"},modalCentered:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},card:{width:"30rem",margin:"0.5rem auto",maxWidth:"80%",display:"flex",flexDirection:"column",alignItems:"center"}},j=Object(C.createMuiTheme)({palette:{primary:{main:"#800080"}},typography:{useNextVariants:!0}}),k=a(33),w={production:{BACKEND_URL:"https://easy-event-0.herokuapp.com"},development:{BACKEND_URL:"http://localhost:3000"}},D=Object(k.a)({},w["production"],{getGraphqlUrl:function(){return this.BACKEND_URL+"/graphql"}}),T=a(34),L=a(8),U=Object(C.withStyles)(function(e){return{close:{padding:e.spacing.unit/2}}})(function(e){var t=e.classes,a=Object(T.a)(e,["classes"]),c=Object(n.useState)(!0),o=Object(s.a)(c,2),i=o[0],l=o[1],u=a.message,m=a.duration,d=a.centered;function E(){l(!1)}return Object(n.useEffect)(function(){null!==m&&void 0!==m&&setTimeout(function(){l(!1)},m)},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(L.k,{anchorOrigin:{vertical:"bottom",horizontal:d?"center":"left"},open:i,autoHideDuration:6e3,onClose:E,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},u),action:[r.a.createElement(L.a,{color:"secondary","aria-label":"Close",onClick:E,className:t.close,key:"close"},"DISMISS")]}))}),B=function(){var e=y().AuthDispatch,t=Object(n.useState)(!0),a=Object(s.a)(t,2),c=a[0],o=a[1],i=Object(n.useState)("PRISTINE"),l=Object(s.a)(i,2),u=l[0],d=l[1],p=Object(n.useRef)({}),f=Object(n.useRef)({});return r.a.createElement(r.a.Fragment,null,"LOGIN_WRONG_CREDENTIALS"===u&&r.a.createElement(U,{message:"Wrong credentials",centered:!0}),"SIGNUP_USER_EXISTS"===u&&r.a.createElement(U,{message:"User already exists",centered:!0}),"SIGNUP_SUCCESS"===u&&r.a.createElement(U,{message:"User Creation have been SUCCESFULL",centered:!0}),"ERROR"===u&&r.a.createElement(U,{message:"Error!: Check connection or call administrator",centered:!0}),r.a.createElement("form",{className:"auth-page",onSubmit:function(t){d("PRISTINE"),t.preventDefault();var a=p.current.value.trim(),n=f.current.value.trim();if(a&&n){var r={query:'\n            mutation {\n                createUser(userInput: {email:"'.concat(a,'", password:"').concat(n,'"}) {\n                  _id\n                  email\n                }\n              }\n            ')},o={query:'\n            query {\n                login(email:"'.concat(a,'", password:"').concat(n,'") {\n                  userId\n                  token\n                  tokenExpiration\n                }\n              }\n            ')};E()({url:D.getGraphqlUrl(),method:"POST",data:c?o:r,headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status&&d("ERROR"),e.data)return e.data.data}).then(function(t){switch(c){case!0:if(!t.login)return void d("LOGIN_WRONG_CREDENTIALS");var a=t.login,n=a.token,r=a.userId,o=a.tokenExpiration;return void e({type:"AUTH_LOG_IN",token:n,userId:r,tokenExpiration:o});case!1:return t.createUser?void d("SIGNUP_SUCCESS"):void d("SIGNUP_USER_EXISTS")}}).catch(function(e){d("ERROR")})}}},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"email"},"E-mail"),r.a.createElement("input",{type:"email",id:"email",ref:p})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",ref:f})),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",style:I.primaryButton},c?"Login":"Signup"),r.a.createElement("span",null),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"button",style:I.primaryButton,onClick:function(e){return o(!c)}},"Switch to ",c?"Signup":"Login")))},G=Object(C.withStyles)(function(e){return{paper:{position:"absolute",width:50*e.spacing.unit,maxWidth:"80%",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],outline:"none"}}})(function(e){var t=e.classes,a=Object(T.a)(e,["classes"]);return r.a.createElement("div",{className:t.paper,style:I.modalCentered},a.children)}),R=a(44),F=a(66),A=a(117),x=a(5632),P=a(5634),H=a(167),q=a(166),K=a(168),J=a(5633),V=a(9),z=a.n(V),W=(a(5595),Object(C.withStyles)(function(e){return{header:{backgroundColor:e.palette.primary.main,color:"white",padding:"0.3rem 1.5rem"},content:{margin:"1.5rem"},actions:{}}})(function(e){var t=e.classes,a=Object(T.a)(e,["classes"]),c=y().AuthState,o=Object(n.useState)(new Date),i=Object(s.a)(o,2),l=i[0],u=i[1],m=Object(n.useState)(new Date),d=Object(s.a)(m,2),p=d[0],f=d[1],b=Object(n.useRef)({}),h=Object(n.useRef)({}),v=Object(n.useRef)({});return r.a.createElement(G,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(L.m,{className:t.header,variant:"h6"},"Create Event"),r.a.createElement("form",{className:z()(t.content,"create-event-modal-content__form"),onSubmit:function(e){e.preventDefault();var t=b.current.value.trim(),n=h.current.value.trim(),r=v.current.value.trim(),o=function(e,t){if(!e||!t)throw new Error("Date and time must be selected");var a=new Date;return a=Object(x.a)(a,Object(P.a)(e)),a=Object(H.a)(a,Object(q.a)(t)),(a=Object(K.a)(a,Object(J.a)(t))).toISOString()}(l,p);if(!t||!n||!r||!o)throw new Error("All input must be selected");var i={query:'mutation {\n                createEvent(eventInput: {title: "'.concat(t,'", description: "').concat(n,'",\n                price: ').concat(parseFloat(r),', date: "').concat(o,'"}) {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                }\n            }')};E()({url:D.getGraphqlUrl(),method:"POST",data:i,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e),a.fetchEvents(),a.closeModal()}).catch(function(e){console.log(e)})}},r.a.createElement(L.g,{className:"create-event-modal-content__title"},r.a.createElement(L.l,{id:"title",variant:"outlined",label:"Title",inputRef:b})),r.a.createElement(L.g,{className:"create-event-modal-content__description"},r.a.createElement(L.l,{id:"description",variant:"outlined",label:"description",inputRef:h})),r.a.createElement(L.g,{className:"create-event-modal-content__date"},r.a.createElement(F.c,{utils:A.a},r.a.createElement(F.a,{keyboard:!0,clearable:!0,variant:"outlined",label:"Date",onChange:u,value:l}))),r.a.createElement(L.g,{className:"create-event-modal-content__time"},r.a.createElement(F.c,{utils:A.a},r.a.createElement(F.b,{keyboard:!0,variant:"outlined",keyboardIcon:r.a.createElement(R.a,null),label:"Time",onChange:f,value:p}))),r.a.createElement(L.g,{className:"create-event-modal-content__price"},r.a.createElement(L.l,{id:"price",variant:"outlined",label:"price",inputRef:v})),r.a.createElement(L.f,{className:"create-event-modal-content__actions-divider"}),r.a.createElement("div",{className:z()(t.actions,"create-event-modal-content__actions")},r.a.createElement(L.a,{variant:"text",color:"primary",onClick:a.closeModal,style:I.primaryButton},"Cancel"),r.a.createElement(L.a,{variant:"contained",color:"primary",type:"submit",style:I.primaryButton},"Create")))))})),M=Object(C.withStyles)(function(e){return{card:Object(k.a)({},I.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(T.a)(e,["classes"]);var n=y().AuthState,c=a.event,o=Boolean(n.token),i=n.userId===c.creator._id;return r.a.createElement(L.b,{className:t.card},r.a.createElement(L.e,{className:t.cardHeader,title:c.title,action:i&&r.a.createElement(L.h,{"aria-label":"Edit"},r.a.createElement(R.b,{fontSize:"small"}))}),r.a.createElement(L.d,{className:t.cardContent},r.a.createElement("span",{className:z()(t.cardContentItem,t.cardDescription)},r.a.createElement(L.m,{variant:"body1",gutterBottom:!0},c.description),r.a.createElement(L.m,{variant:"caption",gutterBottom:!0},new Date(c.date).toLocaleString()),r.a.createElement(L.m,{variant:"h6"},c.price," USD ")),i&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(L.m,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(L.c,{className:t.cardActions},r.a.createElement(L.a,{variant:"text"},"Details"),!i&&r.a.createElement(L.a,{variant:"text",color:"primary",onClick:function(){if(o){var e={query:'mutation {\n                bookEvent(eventId: "'.concat(c._id,'") {\n                  _id\n                  createdAt\n                  updatedAt\n                }\n              }')};E()({url:D.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}else alert("you should log in to book an event")}},"Book this")))}),X=Object(C.withStyles)(function(e){return{}})(function(e){e.classes;var t=y().EventsState.events.map(function(e){return r.a.createElement(M,{event:e,key:e._id})});return r.a.createElement("section",null,t)}),Y=Object(C.withStyles)(function(e){return{card:Object(k.a)({},I.card)}})(function(e){var t=e.classes,a=!0,c=y().EventsDispatch,o=Object(n.useState)(1),i=Object(s.a)(o,2),l=i[0],u=i[1];function d(){a&&u(10),c({type:"FETCH_EVENTS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:{query:"query {\n                events {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                    creator{\n                        _id\n                        email\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_EVENTS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_EVENTS_FULFILLED",events:e.events}),a&&u(100)}).catch(function(e){c({type:"FETCH_EVENTS_REJECTED"})}).finally(function(){setTimeout(function(){a&&u(0)},300)})}Object(n.useEffect)(function(){return d(),function(){a=!1}},[]);var p=y().AuthState,f=Boolean(p.token),b=Object(n.useState)(!1),h=Object(s.a)(b,2),v=h[0],O=h[1];return r.a.createElement("div",{className:"events-page app-centered-page"},Boolean(l)&&r.a.createElement(L.i,{variant:"determinate",value:l}),f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(L.b,{className:t.card},r.a.createElement(L.m,null,"Share your own Event!"),r.a.createElement(m.a,{variant:"contained",color:"primary",type:"button",onClick:function(e){return O(!0)}},"Create Event")),r.a.createElement(L.j,{open:v,onClose:function(e){return O(!1)}},r.a.createElement(W,{closeModal:function(){O(!1)},fetchEvents:d}))),r.a.createElement(X,null))}),Q=Object(C.withStyles)(function(e){return{card:Object(k.a)({},I.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(T.a)(e,["classes"]),n=y(),c=n.AuthState,o=n.BookingsDispatch,i=a.booking,l=i.event,s=Boolean(c.token),u=c.userId===i.event.creator._id;return r.a.createElement(L.b,{className:t.card},r.a.createElement(L.e,{className:t.cardHeader,title:l.title,action:r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(L.h,{"aria-label":"Edit"},r.a.createElement(R.b,{fontSize:"small"})),r.a.createElement(L.h,{"aria-label":"Delete",onClick:function(){if(s){var e={query:'mutation {\n                cancelBooking(bookingId: "'.concat(i._id,'") {\n                  _id\n                  title\n                }\n              }')};o({type:"CANCEL_BOOKINGS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){o({type:"CANCEL_BOOKINGS_FULFILLED",bookingId:i._id}),console.log(e)}).catch(function(e){o({type:"CANCEL_BOOKINGS_REJECTED"}),console.log(e)})}else alert("you should log in to cancel an event")}},r.a.createElement(R.c,{fontSize:"small"})))}),r.a.createElement(L.d,{className:t.cardContent},r.a.createElement("span",{className:z()(t.cardContentItem,t.cardDescription)},r.a.createElement(L.m,{variant:"body1",gutterBottom:!0},l.description),r.a.createElement(L.m,{variant:"caption",gutterBottom:!0},new Date(l.date).toLocaleString()),r.a.createElement(L.m,{variant:"h6"},l.price," USD ")),u&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(L.m,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(L.c,{className:t.cardActions},r.a.createElement(L.a,{variant:"text"},"Details")))}),Z=Object(C.withStyles)(function(e){return{}})(function(e){e.classes;var t=y().BookingsState.bookings.map(function(e){return r.a.createElement(Q,{booking:e,key:e._id})});return r.a.createElement("section",null,t)}),$=Object(C.withStyles)(function(e){return{card:Object(k.a)({},I.card)}})(function(e){e.classes;var t=!0,a=y(),c=a.BookingsDispatch,o=a.AuthState,i=Object(n.useState)(1),l=Object(s.a)(i,2),u=l[0],m=l[1];return Object(n.useEffect)(function(){return t&&m(10),c({type:"FETCH_BOOKINGS_PENDING"}),E()({url:D.getGraphqlUrl(),method:"POST",data:{query:"query {\n                bookings {\n                    _id\n                    createdAt\n                    event {\n                        _id\n                        title\n                        date\n                        price\n                        creator {\n                            _id\n                        }\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.token}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_BOOKINGS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_BOOKINGS_FULFILLED",bookings:e.bookings}),t&&m(100)}).catch(function(e){c({type:"FETCH_BOOKINGS_REJECTED"})}).finally(function(){setTimeout(function(){t&&m(0)},300)}),function(){t=!1}},[]),r.a.createElement("div",{className:"bookins-page .app-centered-page"},Boolean(u)&&r.a.createElement(L.i,{variant:"determinate",value:u}),r.a.createElement(Z,null))}),ee=(a(5617),function(){var e=y().UIDisptch;return r.a.createElement("button",{className:"drawer-toggle-button",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}},r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}))}),te=function(){var e=y().AuthState;return r.a.createElement("nav",null,r.a.createElement("ul",null,!e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/auth"},"Log In")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/events"},"Events")),e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/bookings"},"Bookings"))))},ae=a(36),ne=a.n(ae),re=a(85),ce=a.n(re),oe=a(84),ie=a.n(oe),le=a(65),se=a.n(le),ue=(a(5623),function(){var e=y(),t=e.AuthState,a=e.AuthDispatch,c=Boolean(t.token),o=Object(n.useState)(),i=Object(s.a)(o,2),l=i[0],u=i[1],m=Boolean(l);function d(){u(null)}var E=r.a.createElement(ie.a,{anchorEl:l,open:m,onClose:d},r.a.createElement(se.a,{onClick:void 0},"Profile"),r.a.createElement(se.a,{onClick:function(){a({type:"AUTH_LOG_OUT"}),d()}},"Logout"));return r.a.createElement("header",{className:"main-navigation"},r.a.createElement("span",{className:"main-navigation__logo"},r.a.createElement("span",{className:"main-navigation__button"},r.a.createElement(ee,null)),r.a.createElement("h1",null,"EasyEvent")),r.a.createElement("span",{className:"main-navigation__items"},r.a.createElement("span",{className:"main-navigation__links"},r.a.createElement(te,null)),c&&r.a.createElement(ne.a,{onClick:function(e){u(e.currentTarget)}},r.a.createElement(ce.a,{className:"account-circle"}))),E)}),me=(a(5627),a(5628),function(){var e=["side-drawer"];return y().UIState.isSideDrawOpen&&e.push("side-drawer__open"),r.a.createElement("span",{className:e.join(" ")},r.a.createElement(te,null))}),de=(a(5629),function(){var e=y().UIDisptch;return r.a.createElement("div",{className:"backdrop",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}})});var Ee=function(){var e,t=y(),a=t.UIState,n=t.AuthState,c=Boolean(n.token);return a.isSideDrawOpen&&(e=r.a.createElement(de,null)),r.a.createElement("div",{className:"main-content"},r.a.createElement(i.a,null,r.a.createElement(ue,null),r.a.createElement(me,null),e,r.a.createElement("main",null,r.a.createElement(l.d,null,c&&r.a.createElement(l.a,{from:"/",to:"/events",exact:!0}),c&&r.a.createElement(l.a,{from:"/auth",to:"/events",exact:!0}),!c&&r.a.createElement(l.b,{path:"/auth",component:B}),c&&r.a.createElement(l.b,{path:"/bookings",component:$}),r.a.createElement(l.b,{path:"/events",component:Y}),!c&&r.a.createElement(l.a,{to:"/auth"})))))};o.a.render(r.a.createElement(C.MuiThemeProvider,{theme:j},r.a.createElement(function(e){var t=e.children,a=Object(n.useReducer)(f,p),c=Object(s.a)(a,2),o=c[0],i=c[1],l=Object(n.useReducer)(h,b),u=Object(s.a)(l,2),m=u[0],d=u[1],E=Object(n.useReducer)(g,O),v=Object(s.a)(E,2),y=v[0],C=v[1],I=Object(n.useReducer)(S,_),j=Object(s.a)(I,2),k={UIState:o,UIDisptch:i,AuthState:m,AuthDispatch:d,EventsState:y,EventsDispatch:C,BookingsState:j[0],BookingsDispatch:j[1]};return r.a.createElement(N.Provider,{value:k},t)},null,r.a.createElement(Ee,null))),document.getElementById("root"))}},[[5446,1,2]]]);
//# sourceMappingURL=main.94c05194.chunk.js.map