(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{122:function(e,t,a){},5448:function(e,t,a){e.exports=a(5634)},5474:function(e,t,a){},5599:function(e,t,a){},5621:function(e,t,a){},5627:function(e,t,a){},5631:function(e,t,a){},5632:function(e,t,a){},5633:function(e,t,a){},5634:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),o=a.n(c),i=(a(122),a(53)),l=a(45),s=a(116),u=a.n(s),m=a(166),d=a(18),E=a(23),p=a.n(E),f=a(77),b=a.n(f),h=a(27),v=a.n(h),O=(a(5474),{isSideDrawOpen:!1}),_=function(e,t){switch(t.type){case"UI_TOGGLE_SIDE_NAV":return{isSideDrawOpen:!e.isSideDrawOpen};default:return e||O}},g={token:null,userId:null,tokenExpiration:null},S=function(e,t){switch(t.type){case"AUTH_LOG_IN":return{token:t.token,userId:t.userId,tokenExpiration:t.tokenExpiration};case"AUTH_LOG_OUT":return g;default:return e||g}},y=a(40),N={events:[],status:"PRISTINE"},C=function(e,t){switch(t.type){case"FETCH_EVENTS_PENDING":return{events:Object(y.a)(e.events),status:"PENDING"};case"FETCH_EVENTS_FULFILLED":return{events:Object(y.a)(t.events),status:"FULFILLED"};case"FETCH_EVENTS_REJECTED":return{events:Object(y.a)(e.events),status:"REJECTED"};default:return e||N}},I={bookings:[],status:"PRISTINE"},j=function(e,t){switch(t.type){case"FETCH_BOOKINGS_PENDING":case"CANCEL_BOOKINGS_PENDING":return{bookings:Object(y.a)(e.bookings),status:"PENDING"};case"FETCH_BOOKINGS_FULFILLED":return{bookings:Object(y.a)(t.bookings),status:"FULFILLED"};case"CANCEL_BOOKINGS_FULFILLED":return{bookings:e.bookings.filter(function(e){return t.bookingId!==e._id}),status:"FULFILLED"};case"FETCH_BOOKINGS_REJECTED":case"CANCEL_BOOKINGS_REJECTED":return{bookings:Object(y.a)(e.bookings),status:"REJECTED"};default:return e||I}},k=Object(n.createContext)({}),w=function(){return Object(n.useContext)(k)},T=a(22),D={primaryButton:{margin:"0.25rem 0.1rem"},modalCentered:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},card:{width:"30rem",margin:"0.5rem auto",maxWidth:"80%",display:"flex",flexDirection:"column",alignItems:"center"}},L=Object(T.createMuiTheme)({palette:{primary:{main:"#800080"}},typography:{useNextVariants:!0}}),U=a(33),R={production:{BACKEND_URL:"https://easy-event-0.herokuapp.com"},development:{BACKEND_URL:"http://localhost:3000"}},x=Object(U.a)({},R["production"],{getGraphqlUrl:function(){return this.BACKEND_URL+"/graphql"}}),G=a(34),A=a(8),B=Object(T.withStyles)(function(e){return{close:{padding:e.spacing.unit/2}}})(function(e){var t=e.classes,a=Object(G.a)(e,["classes"]),c=Object(n.useState)(!0),o=Object(d.a)(c,2),i=o[0],l=o[1],s=a.message,u=a.duration,m=a.centered;function E(){l(!1)}return Object(n.useEffect)(function(){null!==u&&void 0!==u&&setTimeout(function(){l(!1)},u)},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(A.k,{anchorOrigin:{vertical:"bottom",horizontal:m?"center":"left"},open:i,autoHideDuration:6e3,onClose:E,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},s),action:[r.a.createElement(A.a,{color:"secondary","aria-label":"Close",onClick:E,className:t.close,key:"close"},"DISMISS")]}))}),F=function(){var e=!0,t=w().AuthDispatch,a=Object(n.useState)(!0),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)("PRISTINE"),s=Object(d.a)(l,2),E=s[0],f=s[1],h=Object(n.useState)(0),O=Object(d.a)(h,2),_=O[0],g=O[1],S=Object(n.useRef)({}),y=Object(n.useRef)({}),N=function(){var a=Object(m.a)(u.a.mark(function a(n){var r,c,i,l;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),!e){a.next=4;break}return a.next=4,f("PRISTINE");case 4:if(r=S.current.value.trim(),c=y.current.value.trim(),r&&c){a.next=11;break}if(!e){a.next=10;break}return a.next=10,f("ATTEMPT_WITH_EMPTY_fORM");case 10:return a.abrupt("return");case 11:e&&g(10),i={query:'\n            mutation {\n                createUser(userInput: {email:"'.concat(r,'", password:"').concat(c,'"}) {\n                  _id\n                  email\n                }\n              }\n            ')},l={query:'\n            query {\n                login(email:"'.concat(r,'", password:"').concat(c,'") {\n                  userId\n                  token\n                  tokenExpiration\n                }\n              }\n            ')},v()({url:x.getGraphqlUrl(),method:"POST",data:o?l:i,headers:{"Content-Type":"application/json"}}).then(function(t){return 200!==t.status&&201!==t.status&&e?f("ERROR"):t.data?t.data.data:void 0}).then(function(a){switch(g(100),o){case!0:if(!a.login&&e)return f("LOGIN_WRONG_CREDENTIALS");if(e){var n=a.login,r=n.token,c=n.userId,i=n.tokenExpiration;return void t({type:"AUTH_LOG_IN",token:r,userId:c,tokenExpiration:i})}case!1:if(!a.createUser&&e)return f("SIGNUP_USER_EXISTS");if(e)return f("SIGNUP_SUCCESS")}}).catch(function(t){if(e)return f("ERROR")}).finally(function(){setTimeout(function(){e&&g(0)},300)});case 15:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}();return Object(n.useEffect)(function(){return function(){e=!1}},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{variant:"determinate",value:_,style:{opacity:_?1:0}}),r.a.createElement("form",{className:"auth-page",onSubmit:N},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"email"},"E-mail"),r.a.createElement("input",{type:"email",id:"email",ref:S})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",ref:y})),r.a.createElement(p.a,{disabled:0<_&&_<100,variant:"contained",color:"primary",type:"submit",style:D.primaryButton},o?"Login":"Signup"),r.a.createElement(p.a,{variant:"text",color:"primary",type:"button",style:D.primaryButton,onClick:function(e){return i(!o)}},"Switch to ",o?"Signup":"Login")),function(){switch(E){case"LOGIN_WRONG_CREDENTIALS":return r.a.createElement(B,{message:"Wrong credentials",centered:!0});case"SIGNUP_USER_EXISTS":return r.a.createElement(B,{message:"User already exists",centered:!0});case"SIGNUP_SUCCESS":return r.a.createElement(B,{message:"User Creation have been SUCCESFULL",centered:!0});case"ERROR":return r.a.createElement(B,{message:"Error!: Check connection or call administrator",centered:!0});case"ATTEMPT_WITH_EMPTY_fORM":return r.a.createElement(B,{message:"Please provide both Email and Password",centered:!0});default:return r.a.createElement("div",null)}}())},P=Object(T.withStyles)(function(e){return{paper:{position:"absolute",width:50*e.spacing.unit,maxWidth:"80%",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],outline:"none"}}})(function(e){var t=e.classes,a=Object(G.a)(e,["classes"]);return r.a.createElement("div",{className:t.paper,style:D.modalCentered},a.children)}),H=a(44),q=a(66),K=a(119),J=a(5636),M=a(5638),V=a(169),W=a(168),z=a(170),Y=a(5637),X=a(9),Q=a.n(X),Z=(a(5599),Object(T.withStyles)(function(e){return{header:{backgroundColor:e.palette.primary.main,color:"white",padding:"0.3rem 1.5rem"},content:{margin:"1.5rem"},actions:{}}})(function(e){var t=e.classes,a=Object(G.a)(e,["classes"]),c=w().AuthState,o=Object(n.useState)(new Date),i=Object(d.a)(o,2),l=i[0],s=i[1],u=Object(n.useState)(new Date),m=Object(d.a)(u,2),E=m[0],p=m[1],f=Object(n.useRef)({}),b=Object(n.useRef)({}),h=Object(n.useRef)({});return r.a.createElement(P,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(A.m,{className:t.header,variant:"h6"},"Create Event"),r.a.createElement("form",{className:Q()(t.content,"create-event-modal-content__form"),onSubmit:function(e){e.preventDefault();var t=f.current.value.trim(),n=b.current.value.trim(),r=h.current.value.trim(),o=function(e,t){if(!e||!t)throw new Error("Date and time must be selected");var a=new Date;return a=Object(J.a)(a,Object(M.a)(e)),a=Object(V.a)(a,Object(W.a)(t)),(a=Object(z.a)(a,Object(Y.a)(t))).toISOString()}(l,E);if(!t||!n||!r||!o)throw new Error("All input must be selected");var i={query:'mutation {\n                createEvent(eventInput: {title: "'.concat(t,'", description: "').concat(n,'",\n                price: ').concat(parseFloat(r),', date: "').concat(o,'"}) {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                }\n            }')};v()({url:x.getGraphqlUrl(),method:"POST",data:i,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e),a.fetchEvents(),a.closeModal()}).catch(function(e){console.log(e)})}},r.a.createElement(A.g,{className:"create-event-modal-content__title"},r.a.createElement(A.l,{id:"title",variant:"outlined",label:"Title",inputRef:f})),r.a.createElement(A.g,{className:"create-event-modal-content__description"},r.a.createElement(A.l,{id:"description",variant:"outlined",label:"description",inputRef:b})),r.a.createElement(A.g,{className:"create-event-modal-content__date"},r.a.createElement(q.c,{utils:K.a},r.a.createElement(q.a,{keyboard:!0,clearable:!0,variant:"outlined",label:"Date",onChange:s,value:l}))),r.a.createElement(A.g,{className:"create-event-modal-content__time"},r.a.createElement(q.c,{utils:K.a},r.a.createElement(q.b,{keyboard:!0,variant:"outlined",keyboardIcon:r.a.createElement(H.a,null),label:"Time",onChange:p,value:E}))),r.a.createElement(A.g,{className:"create-event-modal-content__price"},r.a.createElement(A.l,{id:"price",variant:"outlined",label:"price",inputRef:h})),r.a.createElement(A.f,{className:"create-event-modal-content__actions-divider"}),r.a.createElement("div",{className:Q()(t.actions,"create-event-modal-content__actions")},r.a.createElement(A.a,{variant:"text",color:"primary",onClick:a.closeModal,style:D.primaryButton},"Cancel"),r.a.createElement(A.a,{variant:"contained",color:"primary",type:"submit",style:D.primaryButton},"Create")))))})),$=Object(T.withStyles)(function(e){return{card:Object(U.a)({},D.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(G.a)(e,["classes"]);var n=w().AuthState,c=a.event,o=Boolean(n.token),i=n.userId===c.creator._id;return r.a.createElement(A.b,{className:t.card},r.a.createElement(A.e,{className:t.cardHeader,title:c.title,action:i&&r.a.createElement(A.h,{"aria-label":"Edit"},r.a.createElement(H.b,{fontSize:"small"}))}),r.a.createElement(A.d,{className:t.cardContent},r.a.createElement("span",{className:Q()(t.cardContentItem,t.cardDescription)},r.a.createElement(A.m,{variant:"body1",gutterBottom:!0},c.description),r.a.createElement(A.m,{variant:"caption",gutterBottom:!0},new Date(c.date).toLocaleString()),r.a.createElement(A.m,{variant:"h6"},c.price," USD ")),i&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(A.m,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(A.c,{className:t.cardActions},r.a.createElement(A.a,{variant:"text"},"Details"),!i&&r.a.createElement(A.a,{variant:"text",color:"primary",onClick:function(){if(o){var e={query:'mutation {\n                bookEvent(eventId: "'.concat(c._id,'") {\n                  _id\n                  createdAt\n                  updatedAt\n                }\n              }')};v()({url:x.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}else alert("you should log in to book an event")}},"Book this")))}),ee=Object(T.withStyles)(function(e){return{}})(function(e){e.classes;var t=w().EventsState.events.map(function(e){return r.a.createElement($,{event:e,key:e._id})});return r.a.createElement("section",null,t)}),te=Object(T.withStyles)(function(e){return{card:Object(U.a)({},D.card)}})(function(e){var t=e.classes,a=!0,c=w().EventsDispatch,o=Object(n.useState)(1),i=Object(d.a)(o,2),l=i[0],s=i[1];function u(){a&&s(10),c({type:"FETCH_EVENTS_PENDING"}),v()({url:x.getGraphqlUrl(),method:"POST",data:{query:"query {\n                events {\n                    _id\n                    title\n                    description\n                    date\n                    price\n                    creator{\n                        _id\n                        email\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_EVENTS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_EVENTS_FULFILLED",events:e.events}),a&&s(100)}).catch(function(e){c({type:"FETCH_EVENTS_REJECTED"})}).finally(function(){setTimeout(function(){a&&s(0)},300)})}Object(n.useEffect)(function(){return u(),function(){a=!1}},[]);var m=w().AuthState,E=Boolean(m.token),f=Object(n.useState)(!1),b=Object(d.a)(f,2),h=b[0],O=b[1];return r.a.createElement("div",{className:"events-page app-centered-page"},r.a.createElement(A.i,{variant:"determinate",value:l,style:{opacity:l?1:0}}),E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(A.b,{className:t.card},r.a.createElement(A.m,null,"Share your own Event!"),r.a.createElement(p.a,{variant:"contained",color:"primary",type:"button",onClick:function(e){return O(!0)}},"Create Event")),r.a.createElement(A.j,{open:h,onClose:function(e){return O(!1)}},r.a.createElement(Z,{closeModal:function(){O(!1)},fetchEvents:u}))),r.a.createElement(ee,null))}),ae=Object(T.withStyles)(function(e){return{card:Object(U.a)({},D.card),cardContent:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",margin:"-1rem 0"},cardContentItem:{margin:"1rem 0",flex:"1 0 200px"},cardHeader:{width:"90%",display:"flex",flexDirection:"row",justifyContent:"space-between"},cardDescription:{marginRight:"1rem"},cardActions:{width:"95%",display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.classes,a=Object(G.a)(e,["classes"]),n=w(),c=n.AuthState,o=n.BookingsDispatch,i=a.booking,l=i.event,s=Boolean(c.token),u=c.userId===i.event.creator._id;return r.a.createElement(A.b,{className:t.card},r.a.createElement(A.e,{className:t.cardHeader,title:l.title,action:r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(A.h,{"aria-label":"Edit"},r.a.createElement(H.b,{fontSize:"small"})),r.a.createElement(A.h,{"aria-label":"Delete",onClick:function(){if(s){var e={query:'mutation {\n                cancelBooking(bookingId: "'.concat(i._id,'") {\n                  _id\n                  title\n                }\n              }')};o({type:"CANCEL_BOOKINGS_PENDING"}),v()({url:x.getGraphqlUrl(),method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");if(e.data)return e.data.data}).then(function(e){o({type:"CANCEL_BOOKINGS_FULFILLED",bookingId:i._id}),console.log(e)}).catch(function(e){o({type:"CANCEL_BOOKINGS_REJECTED"}),console.log(e)})}else alert("you should log in to cancel an event")}},r.a.createElement(H.c,{fontSize:"small"})))}),r.a.createElement(A.d,{className:t.cardContent},r.a.createElement("span",{className:Q()(t.cardContentItem,t.cardDescription)},r.a.createElement(A.m,{variant:"body1",gutterBottom:!0},l.description),r.a.createElement(A.m,{variant:"caption",gutterBottom:!0},new Date(l.date).toLocaleString()),r.a.createElement(A.m,{variant:"h6"},l.price," USD ")),u&&r.a.createElement("span",{className:t.cardContentItem},r.a.createElement(A.m,{variant:"caption"},"You are the owner of this event"))),r.a.createElement(A.c,{className:t.cardActions},r.a.createElement(A.a,{variant:"text"},"Details")))}),ne=Object(T.withStyles)(function(e){return{}})(function(e){e.classes;var t=w().BookingsState.bookings.map(function(e){return r.a.createElement(ae,{booking:e,key:e._id})});return r.a.createElement("section",null,t)}),re=Object(T.withStyles)(function(e){return{card:Object(U.a)({},D.card)}})(function(e){e.classes;var t=!0,a=w(),c=a.BookingsDispatch,o=a.AuthState,i=Object(n.useState)(1),l=Object(d.a)(i,2),s=l[0],u=l[1];return Object(n.useEffect)(function(){return t&&u(10),c({type:"FETCH_BOOKINGS_PENDING"}),v()({url:x.getGraphqlUrl(),method:"POST",data:{query:"query {\n                bookings {\n                    _id\n                    createdAt\n                    event {\n                        _id\n                        title\n                        date\n                        price\n                        creator {\n                            _id\n                        }\n                    }\n                }\n            }"},headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.token}}).then(function(e){if(200!==e.status&&201!==e.status&&c({type:"FETCH_BOOKINGS_REJECTED"}),e.data)return e.data.data}).then(function(e){c({type:"FETCH_BOOKINGS_FULFILLED",bookings:e.bookings}),t&&u(100)}).catch(function(e){c({type:"FETCH_BOOKINGS_REJECTED"})}).finally(function(){setTimeout(function(){t&&u(0)},300)}),function(){t=!1}},[]),r.a.createElement("div",{className:"bookins-page .app-centered-page"},r.a.createElement(A.i,{variant:"determinate",value:s,style:{opacity:s?1:0}}),r.a.createElement(ne,null))}),ce=(a(5621),function(){var e=w().UIDisptch;return r.a.createElement("button",{className:"drawer-toggle-button",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}},r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}),r.a.createElement("div",{className:"drawer-toggle-button__line"}))}),oe=function(){var e=w().AuthState;return r.a.createElement("nav",null,r.a.createElement("ul",null,!e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/auth"},"Log In")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/events"},"Events")),e.token&&r.a.createElement("li",null,r.a.createElement(i.b,{to:"/bookings"},"Bookings"))))},ie=a(36),le=a.n(ie),se=a(86),ue=a.n(se),me=a(85),de=a.n(me),Ee=a(65),pe=a.n(Ee),fe=(a(5627),function(){var e=w(),t=e.AuthState,a=e.AuthDispatch,c=Boolean(t.token),o=Object(n.useState)(),i=Object(d.a)(o,2),l=i[0],s=i[1],u=Boolean(l);function m(){s(null)}var E=r.a.createElement(de.a,{anchorEl:l,open:u,onClose:m},r.a.createElement(pe.a,{onClick:void 0},"Profile"),r.a.createElement(pe.a,{onClick:function(){a({type:"AUTH_LOG_OUT"}),m()}},"Logout"));return r.a.createElement("header",{className:"main-navigation"},r.a.createElement("span",{className:"main-navigation__logo"},r.a.createElement("span",{className:"main-navigation__button"},r.a.createElement(ce,null)),r.a.createElement("h1",null,"EasyEvent")),r.a.createElement("span",{className:"main-navigation__items"},r.a.createElement("span",{className:"main-navigation__links"},r.a.createElement(oe,null)),c&&r.a.createElement(le.a,{onClick:function(e){s(e.currentTarget)}},r.a.createElement(ue.a,{className:"account-circle"}))),E)}),be=(a(5631),a(5632),function(){var e=["side-drawer"];return w().UIState.isSideDrawOpen&&e.push("side-drawer__open"),r.a.createElement("span",{className:e.join(" ")},r.a.createElement(oe,null))}),he=(a(5633),function(){var e=w().UIDisptch;return r.a.createElement("div",{className:"backdrop",onClick:function(){e({type:"UI_TOGGLE_SIDE_NAV"})}})});var ve=function(){var e,t=w(),a=t.UIState,n=t.AuthState,c=Boolean(n.token);return a.isSideDrawOpen&&(e=r.a.createElement(he,null)),r.a.createElement("div",{className:"main-content"},r.a.createElement(i.a,null,r.a.createElement(fe,null),r.a.createElement(be,null),e,r.a.createElement("main",null,r.a.createElement(l.d,null,c&&r.a.createElement(l.a,{from:"/",to:"/events",exact:!0}),c&&r.a.createElement(l.a,{from:"/auth",to:"/events",exact:!0}),!c&&r.a.createElement(l.b,{path:"/auth",component:F}),c&&r.a.createElement(l.b,{path:"/bookings",component:re}),r.a.createElement(l.b,{path:"/events",component:te}),!c&&r.a.createElement(l.a,{to:"/auth"})))))};o.a.render(r.a.createElement(T.MuiThemeProvider,{theme:L},r.a.createElement(function(e){var t=e.children,a=Object(n.useReducer)(_,O),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useReducer)(S,g),s=Object(d.a)(l,2),u=s[0],m=s[1],E=Object(n.useReducer)(C,N),p=Object(d.a)(E,2),f=p[0],b=p[1],h=Object(n.useReducer)(j,I),v=Object(d.a)(h,2),y={UIState:o,UIDisptch:i,AuthState:u,AuthDispatch:m,EventsState:f,EventsDispatch:b,BookingsState:v[0],BookingsDispatch:v[1]};return r.a.createElement(k.Provider,{value:y},t)},null,r.a.createElement(ve,null))),document.getElementById("root"))}},[[5448,1,2]]]);
//# sourceMappingURL=main.cdf778cc.chunk.js.map